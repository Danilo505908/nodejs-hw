# –ü–ª–∞–Ω –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è: Express + MongoDB

## üìã –ó–∞–≥–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è
- **–ì—ñ–ª–∫–∞**: `02-mongodb`
- **–ú–µ—Ç–∞**: –°—Ç–≤–æ—Ä–∏—Ç–∏ Express-–¥–æ–¥–∞—Ç–æ–∫ –∑ MongoDB —á–µ—Ä–µ–∑ Mongoose –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—é –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—î—é –∫–æ–¥—É

---

## üéØ –ö—Ä–æ–∫ 1: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ—î–∫—Ç—É

### 1.1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –≥—ñ–ª–∫—É
```bash
git checkout -b 02-mongodb
```

### 1.2. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞–∫–µ—Ç–∏
```bash
npm install mongoose http-errors
```

---

## üóÑÔ∏è –ö—Ä–æ–∫ 2: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è MongoDB Atlas

### 2.1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä –≤ MongoDB Atlas
1. –ó–∞–π—Ç–∏ –Ω–∞ https://www.mongodb.com/cloud/atlas
2. –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –∫–ª–∞—Å—Ç–µ—Ä (–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π M0)
3. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –º–µ—Ä–µ–∂—ñ:
   - –ü–µ—Ä–µ–π—Ç–∏ –≤ "Network Access"
   - –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ "+ ADD IP ADDRESS"
   - –í–∏–±—Ä–∞—Ç–∏ "ALLOW ACCESS FROM ANYWHERE" (0.0.0.0/0)
   - –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏

### 2.2. –û—Ç—Ä–∏–º–∞—Ç–∏ connection string
1. –ü–µ—Ä–µ–π—Ç–∏ –≤ "Database Access" ‚Üí —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ "Database" ‚Üí "Connect" ‚Üí "Connect your application"
3. –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ connection string (–≤–∏–≥–ª—è–¥–∞—î —è–∫: `mongodb+srv://username:password@cluster.mongodb.net/`)

### 2.3. –î–æ–¥–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è
–°—Ç–≤–æ—Ä–∏—Ç–∏/–æ–Ω–æ–≤–∏—Ç–∏ —Ñ–∞–π–ª `.env`:
```
PORT=3000
MONGO_URL=mongodb+srv://username:password@cluster.mongodb.net/notes-db?retryWrites=true&w=majority
```
‚ö†Ô∏è **–í–∞–∂–ª–∏–≤–æ**: –ó–∞–º—ñ–Ω–∏—Ç–∏ `username`, `password` —Ç–∞ `cluster` –Ω–∞ —Å–≤–æ—ó –¥–∞–Ω—ñ

---

## üìÅ –ö—Ä–æ–∫ 3: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø–∞–ø–æ–∫

–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –ø–∞–ø–∫–∏ —Ç–∞ —Ñ–∞–π–ª–∏:
```
src/
‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îî‚îÄ‚îÄ connectMongoDB.js
‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îú‚îÄ‚îÄ logger.js
‚îÇ   ‚îú‚îÄ‚îÄ notFoundHandler.js
‚îÇ   ‚îî‚îÄ‚îÄ errorHandler.js
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ note.js
‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îî‚îÄ‚îÄ notesController.js
‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îî‚îÄ‚îÄ notesRoutes.js
‚îî‚îÄ‚îÄ server.js
```

---

## üîå –ö—Ä–æ–∫ 4: –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ MongoDB

### 4.1. –°—Ç–≤–æ—Ä–∏—Ç–∏ `src/db/connectMongoDB.js`
- –Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ `mongoose`
- –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é `connectMongoDB()`
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ `process.env.MONGO_URL`
- –ü—Ä–∏ —É—Å–ø—ñ—à–Ω–æ–º—É –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—ñ –≤–∏–≤–µ—Å—Ç–∏: `"‚úÖ MongoDB connection established successfully"`
- –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é

---

## üõ†Ô∏è –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Middleware

### 5.1. `src/middleware/logger.js`
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ `pino-http`
- –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ middleware –¥–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è

### 5.2. `src/middleware/notFoundHandler.js`
- –û–±—Ä–æ–±–∫–∞ 404 –ø–æ–º–∏–ª–æ–∫
- –ü–æ–≤–µ—Ä—Ç–∞—Ç–∏: `{ message: 'Route not found' }`

### 5.3. `src/middleware/errorHandler.js`
- –ì–ª–æ–±–∞–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ `http-errors` –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å—Ç–∞—Ç—É—Å—ñ–≤
- –ü–æ–≤–µ—Ä—Ç–∞—Ç–∏: `{ message: –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É }`

---

## üìù –ö—Ä–æ–∫ 6: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ Note

### 6.1. –°—Ç–≤–æ—Ä–∏—Ç–∏ `src/models/note.js`
–ú–æ–¥–µ–ª—å –º–∞—î –º—ñ—Å—Ç–∏—Ç–∏:
- `title` - –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π —Ä—è–¥–æ–∫, `trim: true`
- `content` - –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π —Ä—è–¥–æ–∫ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º `''`), `trim: true`
- `tag` - enum: `['Work', 'Personal', 'Meeting', 'Shopping', 'Ideas', 'Travel', 'Finance', 'Health', 'Important', 'Todo']`, –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º `'Todo'`
- `timestamps: true` (–¥–ª—è `createdAt` —Ç–∞ `updatedAt`)

### 6.2. –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª `notes.json` –∑ —Ç–µ—Å—Ç–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏
(–ü–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ MongoDB Compass –∞–±–æ —ñ–Ω—à–∏–π UI)

---

## üéÆ –ö—Ä–æ–∫ 7: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ–≤

### 7.1. –°—Ç–≤–æ—Ä–∏—Ç–∏ `src/controllers/notesController.js`
–†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó:
- `getAllNotes` - GET /notes (—Å—Ç–∞—Ç—É—Å 200)
- `getNoteById` - GET /notes/:noteId (—Å—Ç–∞—Ç—É—Å 200 –∞–±–æ 404 —á–µ—Ä–µ–∑ `createHttpError`)
- `createNote` - POST /notes (—Å—Ç–∞—Ç—É—Å 201)
- `updateNote` - PATCH /notes/:noteId (—Å—Ç–∞—Ç—É—Å 200 –∞–±–æ 404)
- `deleteNote` - DELETE /notes/:noteId (—Å—Ç–∞—Ç—É—Å 200 –∞–±–æ 404)

‚ö†Ô∏è **–í–∞–∂–ª–∏–≤–æ**: –ù–∞–∑–≤–∏ —Ñ—É–Ω–∫—Ü—ñ–π –Ω–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏!

---

## üõ£Ô∏è –ö—Ä–æ–∫ 8: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–æ—É—Ç—ñ–≤

### 8.1. –°—Ç–≤–æ—Ä–∏—Ç–∏ `src/routes/notesRoutes.js`
- –Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ `express.Router()`
- –Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤—Å—ñ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∏
- –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ —Ä–æ—É—Ç–∏:
  - `GET /` ‚Üí `getAllNotes`
  - `GET /:noteId` ‚Üí `getNoteById`
  - `POST /` ‚Üí `createNote`
  - `PATCH /:noteId` ‚Üí `updateNote`
  - `DELETE /:noteId` ‚Üí `deleteNote`
- –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ router

---

## üñ•Ô∏è –ö—Ä–æ–∫ 9: –û–Ω–æ–≤–ª–µ–Ω–Ω—è server.js

### 9.1. –û–Ω–æ–≤–∏—Ç–∏ `src/server.js`
1. –Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤—Å—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –º–æ–¥—É–ª—ñ
2. –í–∏–∫–ª–∏–∫–∞—Ç–∏ `connectMongoDB()` **–¥–æ** –∑–∞–ø—É—Å–∫—É —Å–µ—Ä–≤–µ—Ä–∞
3. –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ middleware –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É:
   - `logger` (pino-http)
   - `express.json()`
   - `cors()`
4. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ —Ä–æ—É—Ç–∏: `app.use('/notes', notesRoutes)`
5. –í–∏–¥–∞–ª–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤–∏–π —Ä–æ—É—Ç `/test-error`
6. –î–æ–¥–∞—Ç–∏ `notFoundHandler` –ø—ñ—Å–ª—è –≤—Å—ñ—Ö —Ä–æ—É—Ç—ñ–≤
7. –î–æ–¥–∞—Ç–∏ `errorHandler` –æ—Å—Ç–∞–Ω–Ω—ñ–º

---

## üß™ –ö—Ä–æ–∫ 10: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ

### 10.1. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä
```bash
npm run dev
```

### 10.2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Å—ñ —Ä–æ—É—Ç–∏:
- ‚úÖ `GET http://localhost:3000/notes`
- ‚úÖ `GET http://localhost:3000/notes/:noteId`
- ‚úÖ `POST http://localhost:3000/notes`
- ‚úÖ `PATCH http://localhost:3000/notes/:noteId`
- ‚úÖ `DELETE http://localhost:3000/notes/:noteId`
- ‚úÖ `GET http://localhost:3000/nonexistent` (–º–∞—î –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ 404)

### 10.3. –Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ
- –í—ñ–¥–∫—Ä–∏—Ç–∏ MongoDB Compass –∞–±–æ Atlas UI
- –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ –±–∞–∑–∏
- –Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –∑ `notes.json` –¥–æ –∫–æ–ª–µ–∫—Ü—ñ—ó `notes`

---

## üöÄ –ö—Ä–æ–∫ 11: –î–µ–ø–ª–æ–π –Ω–∞ Render.com

### 11.1. –ü—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ –ø—Ä–æ—î–∫—Ç
1. –ü–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ `.env` –≤ `.gitignore`
2. –ó–∞–∫–æ–º—ñ—Ç–∏—Ç–∏ –≤—Å—ñ –∑–º—ñ–Ω–∏:
   ```bash
   git add .
   git commit -m "Add MongoDB integration with CRUD operations"
   git push origin 02-mongodb
   ```

### 11.2. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ Render.com
1. –ó–∞–π—Ç–∏ –Ω–∞ https://render.com
2. –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π "Web Service"
3. –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π GitHub
4. –í–∏–±—Ä–∞—Ç–∏ –≥—ñ–ª–∫—É `02-mongodb`
5. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
   - **Build Command**: `npm install`
   - **Start Command**: `npm start`
   - **Environment**: Node
6. –î–æ–¥–∞—Ç–∏ Environment Variables:
   - `PORT` (Render –º–æ–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
   - `MONGO_URL` (—Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –∑ `.env`)

### 11.3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–µ–ø–ª–æ–π
1. –î–æ—á–µ–∫–∞—Ç–∏—Å—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—é
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Å—ñ —Ä–æ—É—Ç–∏ –Ω–∞ –∑–∞–¥–µ–ø–ª–æ—î–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ
3. –ü–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ MongoDB –ø—Ä–∞—Ü—é—î

---

## ‚úÖ –ö—Ä–æ–∫ 12: –§—ñ–Ω–∞–ª—å–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞

### 12.1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Å—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó:
- ‚úÖ –ö–æ–¥ –Ω–∞ –≥—ñ–ª—Ü—ñ `02-mongodb`
- ‚úÖ –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ GitHub
- ‚úÖ –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ Render.com
- ‚úÖ –ö–æ–¥ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –±–µ–∑ –ø–æ–º–∏–ª–æ–∫
- ‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ MongoDB –ø—Ä–∞—Ü—é—î
- ‚úÖ –ó–º—ñ–Ω–Ω—ñ `PORT` —Ç–∞ `MONGO_URL` –≤ `.env`
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ `pino-http`
- ‚úÖ –í—Å—ñ 5 CRUD-–æ–ø–µ—Ä–∞—Ü—ñ–π —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ
- ‚úÖ –û–±—Ä–æ–±–∫–∞ 404
- ‚úÖ –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ (500 —Ç–∞ —á–µ—Ä–µ–∑ http-errors)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞ —Ñ–∞–π–ª–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### 12.2. –î–æ—á–µ–∫–∞—Ç–∏—Å—è 5 —Ö–≤–∏–ª–∏–Ω –ø—ñ—Å–ª—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∫–æ–º—ñ—Ç—É
(–©–æ–± GitHub –æ–Ω–æ–≤–∏–≤ –≤–µ—Ä—Å—ñ—é)

---

## üìù –î–æ–¥–∞—Ç–∫–æ–≤—ñ –Ω–æ—Ç–∞—Ç–∫–∏

- –ù–∞–∑–≤–∏ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ–≤ –Ω–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏!
- –ù–∞–∑–≤–∏ –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è: `PORT` —Ç–∞ `MONGO_URL` (—Ç–æ—á–Ω–æ —Ç–∞–∫!)
- –®–ª—è—Ö `/notes` –Ω–µ –≤–∏–Ω–æ—Å–∏—Ç–∏ –≤ `server.js` - –≤—ñ–Ω –º–∞—î –±—É—Ç–∏ –≤ `notesRoutes.js`
- –ü—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `createHttpError` –∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ `http-errors`
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–∞–ª—ñ–¥–Ω–æ—Å—Ç—ñ MongoDB ID –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –Ω–∞ —Ü—å–æ–º—É –µ—Ç–∞–ø—ñ

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—ñ—Ö –∫—Ä–æ–∫—ñ–≤ –∑–∞–≤–¥–∞–Ω–Ω—è –≥–æ—Ç–æ–≤–µ –¥–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏!

